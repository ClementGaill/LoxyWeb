<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Svetlana</title>
  <style>
    :root {
      --bg: #fff;
      --panel: #c5c5c5;
      --muted: #000;
      --text: #000;
      --accent: #000;
      --card: #5e83b6;
      --border: #5e83b6;
    }
    html, body { height: 100%; margin: 0; }
    body {
      background: var(--bg); color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial;
    }
    .container { max-width: 1100px; margin: 0 auto; padding: 16px; }
    header { display:flex; align-items:center; justify-content:space-between; gap: 16px; padding: 12px 0; }
    .logo { font-weight: 700; letter-spacing: .3px; }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 16px; }
    .card { background: var(--card); border:1px solid var(--border); border-radius: 16px; overflow: hidden; display:flex; flex-direction:column; }
    .card header { padding: 12px 14px; border-bottom:1px solid var(--border); }
    .title { font-size: 14px; font-weight: 600; }
    .meta { font-size: 12px; color: var(--muted); }
    video, audio { width: 100%; height:auto; display: block; background: #000; }
    footer { text-align:center; color: var(--muted); font-size: 12px; padding: 20px 0 40px; }
    .searchbar { display:flex; flex-wrap: wrap; gap:8px; }
    .searchbar input, .searchbar select, .searchbar button {
      flex:1; min-width: 120px; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background: var(--panel); color: var(--text);
    }
    .pill { font-size:12px; background: rgba(34,211,238,.12); color: var(--accent); border:1px solid rgba(34,211,238,.4); padding:2px 8px; border-radius:999px; }
    .audio-player { padding: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">üìÅ</div>
    </header>

    <section class="searchbar" style="margin: 10px 0 22px;">
      <input id="q" placeholder="Rechercher un m√©dia‚Ä¶" />
      <select id="type">
        <option value="all">Tous</option>
        <option value="video">Vid√©os</option>
        <option value="audio">Audios</option>
      </select>
      <button id="clear">Effacer</button>
    </section>

    <section class="grid" id="grid"></section>

    <footer>
      <div>Make with üòîüíñ</div>
    </footer>
  </div>

  <script>
    // --- Donn√©es (remplacez les src par vos fichiers en local) ---
    const MEDIA = [
      { id: "v1", type: "video", title: "Pr√©sentation", src: "./assets/svetlana/pres.mp4", size: 12345678, createdAt: "22/08/2025" },
      { id: "a1", type: "audio", title: "Medecin", src: "./assets/svetlana/MedecinRuptute.mp3", size: 2345678, createdAt: "21/08/2025" },
    ];

    const grid = document.getElementById('grid');
    const q = document.getElementById('q');
    const type = document.getElementById('type');
    const clearBtn = document.getElementById('clear');

    function formatSize(bytes){
      if (!bytes && bytes !== 0) return '';
      const units = ['o','Ko','Mo','Go','To'];
      let i=0; let val = bytes;
      while(val >= 1024 && i < units.length-1){ val/=1024; i++; }
      return `${val.toFixed( (i===0)?0:(val<10?1:0) )} ${units[i]}`;
    }

    function render(items){
      grid.innerHTML = '';
      items.forEach(item => {
        const card = document.createElement('article');
        card.className = 'card';

        const head = document.createElement('header');
        head.innerHTML = `<div class="title">${item.title}</div><div class="meta">${item.type.toUpperCase()} ¬∑ ${item.createdAt}</div>`;
        card.appendChild(head);

        if(item.type === 'video'){
          const el = document.createElement('video');
          el.src = item.src; el.controls = true; el.preload = 'metadata';
          card.appendChild(el);
        } else if(item.type === 'audio'){
          const wrapper = document.createElement('div');
          wrapper.className = 'audio-player';

          const el = document.createElement('audio');
          el.src = item.src; el.controls = true; el.preload = 'metadata';
          wrapper.appendChild(el);

          card.appendChild(wrapper);
        }

        const foot = document.createElement('div');
        foot.style.display='flex';
        foot.style.justifyContent='space-between';
        foot.style.alignItems='center';
        foot.style.gap='8px';
        foot.style.padding='10px 14px';
        foot.style.borderTop='1px solid var(--border)';
        foot.innerHTML = `<span class="pill">${item.id}</span><a href="${item.src}" download style="color:var(--accent); text-decoration:none;">T√©l√©charger</a>`;
        card.appendChild(foot);

        grid.appendChild(card);
      });
    }

    function applyFilters(){
      const term = q.value.trim().toLowerCase();
      const t = type.value;
      const filtered = MEDIA.filter(m => (t==='all' || m.type===t) && (!term || m.title.toLowerCase().includes(term)));
      render(filtered);
    }

    q.addEventListener('input', applyFilters);
    type.addEventListener('change', applyFilters);
    clearBtn.addEventListener('click', () => { q.value=''; type.value='all'; applyFilters(); });

    render(MEDIA);
  </script>
    <script type="module">
        import { createClient } from "https://esm.sh/@supabase/supabase-js";

        const SUPABASE_URL = "https://focmcruwyifaoqueymmg.supabase.co";   // ton url
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZvY21jcnV3eWlmYW9xdWV5bW1nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NjExODYsImV4cCI6MjA2NjMzNzE4Nn0.MbD1ogT5U5pBK-xKRZY--ol5pHzY_QKrJU9LfAsFEdk";          // ta cl√© anonyme
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        function getBrowserInfo() {
        const ua = navigator.userAgent;
        const device = /mobile/i.test(ua) ? "mobile" : "desktop";
        const os = /windows/i.test(ua) ? "Windows" : /mac/i.test(ua) ? "Mac" : /linux/i.test(ua) ? "Linux" : "Other";
        const browser = /chrome/i.test(ua) ? "Chrome" : /firefox/i.test(ua) ? "Firefox" : /safari/i.test(ua) ? "Safari" : "Other";
        return { ua, device, os, browser };
        }

        async function trackVisit() {
        const { ua, device, os, browser } = getBrowserInfo();
        const page = location.pathname + location.search;

        await supabase.from("visits").insert({
            ua,
            device,
            os,
            browser,
            page
        });
        }

        // Appelle la fonction d√®s que la page est charg√©e
        trackVisit();
    </script>

</body>
</html>
